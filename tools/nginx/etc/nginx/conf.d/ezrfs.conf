server {
  listen 80 default_server;
  listen [::]:80 default_server;

#  listen 443 ssl http2;

  server_name  ezrfs.mooo.com;

#  ssl_dhparam /etc/nginx/dhparam.pem;

#  ssl_stapling on;
#  ssl on;
#  ssl_certificate /etc/nginx/ssl/ssl-startssl-bundle.crt;
#  ssl_certificate_key /etc/nginx/ssl/ssl-startssl-iconiux.com.key;
#  ssl_certificate /etc/letsencrypt/live/mprove.iconiux.com/fullchain.pem;
#  ssl_certificate_key /etc/letsencrypt/live/mprove.iconiux.com/privkey.pem;
  
#  ssl_session_timeout  15m;
#  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
#  ssl_ciphers 'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:!DSS';
#  ssl_prefer_server_ciphers on;
#  ssl_session_cache shared:SSL:50m;

  # HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)
#  add_header Strict-Transport-Security "max-age=15768000;";
  add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
  add_header X-XSS-Protection  "1; mode=block" always;
  add_header X-Content-Type-Options  "nosniff" always;
  add_header X-Frame-Options "SAMEORIGIN" always;
  add_header Referrer-Policy "same-origin" always;

  underscores_in_headers on;

  root /var/www/html;
  index index.html index.htm index.nginx-debian.html;

  location /api/v1 {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-Proto https;
    proxy_set_header X-Url-Scheme $scheme;
    proxy_redirect off;
    proxy_connect_timeout      240;
    proxy_send_timeout         240;
    proxy_read_timeout         240;
    # note, there is not SSL here! plain HTTP is used
    proxy_pass http://127.0.0.1:8081/;

#    auth_basic           "closed site";
#    auth_basic_user_file htpasswd;
  }

	location / {
		try_files $uri $uri/ =404;
	}
}

